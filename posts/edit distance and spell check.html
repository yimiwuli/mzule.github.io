<!DOCTYPE html>
<!-- Website template by freewebsitetemplates.com -->
<html>
<head>
	<meta charset="UTF-8">
	<title>Blog of MZULE | 最小编辑距离，键盘距离与拼写纠正</title>
	<link rel="stylesheet" href="../css/style.css" type="text/css">
</head>
<body>
	<div id="page">
		<div id="header">
			<div>
				<a href="../index.html" id="logo">MZULE</a>
				<ul id="navigation">
					<li>
						<a href="../index.html">home</a>
					</li>
					<li>
						<a href="../me.html">about</a>
					</li>
					<li>
						<a href="http://weibo.com/u/2634262551/home?wvr=5">weibo</a>
					</li>
					<li>
						<a href="http://stackoverflow.com/users/1985786/jason-cao">stackoverflow</a>
					</li>
					<li>
						<a href="http://github.com/mzule/">github</a>
					</li>
					<li>
						<a href="http://www.zhihu.com/people/mzule">zhihu</a>
					</li>
				</ul>
			</div>
		</div>


		<div id="contents">
			<ul id="blogs">
				<li>
					<div class="header">
						<div class="details">
							<h3><a href="posts/edit distance and spell check.html">最小编辑距离，键盘距离与拼写纠正</a></h3>
							<div id="postContent">
							<div id="cnblogs_post_body"><p>最小编辑距离是指将一个错误拼写的单词纠正正确的最小编辑次数，这里的编辑包含插入、删除、修改三种操作，每一次编辑只能改变一个字母。因为这个概念是俄罗斯科学家&nbsp;Vladimir Levenshtein 在1965年提出来的，所以编辑距离又称为Levenshtein距离。<a title="1965年" href="http://zh.wikipedia.org/wiki/1965%E5%B9%B4"><br></a></p><p>就拿‘Levenshtein’这个单词举例说明好了，Levenshtein作为一个人名，很容易会被拼写错误。假设现在有一个错误拼写的Lavensting. 那么他们的编辑距离是多少呢？</p><p>参考正确的单词Levenshtein，可以看出，由Lavensting纠正为Levenshtein的步骤为:</p><p>Lavensting V.S. Levenshtein</p><p>1. 将第二个字母a修改为e；</p><p>2. 在第六个字母s后面插入h；</p><p>3. 在第七个字母t后面插入e；</p><p>4. 将最后一个字母g删除。</p><p>这里我们进行了四次操作，所以Lavensting和Levenstein的编辑距离是4. 而且我们可以目测出这已经是最小编辑距离了。</p><p>那么我们怎么使用最小编辑距离为错误拼写的单词进行纠正呢？原理很简单，也很粗暴。用单词库里面的所有单词与错误拼写的单词计算最小编辑距离，最小编辑距离最小的单词，便很可能是正确的单词，也就是纠正的结果。</p><p>接下来，接下来便是如何使用计算机求解最小编辑距离。动态规划经常<span>被用来作为这个问题的解决手段之一。</span></p><p><span><span>笔者水平有限，动态规划难以描述清楚，这里给一个定义：动态规划是通过把原问题分解为相对简单的子问题的方式求解复杂问题的方法。</span></span></p><p><span><span>下面是java代码：</span></span></p><div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.mzule.al;</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> LevenshteinDistance {    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> distance(String w1,String w2){        </span><span style="color: #0000ff;">double</span>[][] m = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">double</span>[w1.length()+1][w2.length()+1<span style="color: #000000;">];        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=0;i&lt;m.length;i++<span style="color: #000000;">){            m[i][</span>0]=<span style="color: #000000;">i;        }        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=0;i&lt;m[0].length;i++<span style="color: #000000;">){            m[</span>0][i]=<span style="color: #000000;">i;        }        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=1;i&lt;m.length;i++<span style="color: #000000;">){            </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j=1;j&lt;m[0].length;j++<span style="color: #000000;">){                m[i][j] </span>= min(m[i][j-1]+1,m[i-1][j]+1,m[i-1][j-1]+cost(w1.charAt(i-1),w2.charAt(j-1<span style="color: #000000;">)));            }        }        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> m[w1.length()][w2.length()];    }    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">double</span> cost(<span style="color: #0000ff;">char</span> c1,<span style="color: #0000ff;">char</span><span style="color: #000000;"> c2) {        </span><span style="color: #0000ff;">return</span> c1==c2?0:1<span style="color: #000000;">;    }    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">double</span> min(<span style="color: #0000ff;">double</span> i, <span style="color: #0000ff;">double</span> j, <span style="color: #0000ff;">double</span><span style="color: #000000;"> k) {        </span><span style="color: #0000ff;">double</span> t = i&lt;j?<span style="color: #000000;">i:j;        </span><span style="color: #0000ff;">return</span> t&lt;k?<span style="color: #000000;">t:k;    }    }</span></pre><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div><p>&nbsp;</p><p>上面的核心代码是两个for循环中的部分：</p><div class="cnblogs_code"><pre>m[i][j] = min(m[i][j-1]+1,m[i-1][j]+1,m[i-1][j-1]+cost(w1.charAt(i-1),w2.charAt(j-1)));</pre></div><p>&nbsp;</p><p>这段代码可以这样理解，例如我们已知ab与a、a与a、a与ac的距离，计算字符串 ab与ac的距离，有三个方式，对应于编辑操作的插入、删除、修改三种操作：</p><p>1. 在ab与a的距离基础上+1，因为ac多了一个c；</p><p>2. 在a与ac的距离的基础上+1，因为ab多了一个b；</p><p>3. 在a与a的距离的基础上加上b与c的距离，b与c的距离很简单，因为b与c不相等，为1</p><p>测试上面的代码运行效果：</p><div class="cnblogs_code"><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {    </span><span style="color: #0000ff;">double</span> d = <span style="color: #0000ff;">new</span> LevenshteinDistance().distance("Lavensting", "Levenshtein"<span style="color: #000000;">);    System.out.println(d);}</span></pre></div><p>&nbsp;</p><p>输出的结果为：4.0，和我们之前目测的结果一样。</p><p>好了，现在我们可以用这个算法去做拼写纠错了。</p><p>但是这个算法不够完美，因为没有考虑到键盘距离。</p><p>在上面程序中的cost方法，只是简单的对相同的字符返回0，不同的字符返回1。这种情况下，cost(‘a’,‘p’)和cost(‘a’,‘s’)的值是一样的，都是1. 但是他们应该是不一样的，因为a被误输入为s的概率比误输入为p的概率大得多，因为在键盘上，a与s是邻居，手指很容易误按，而p与a距离太远，用户输入p基本上都是真实的想法。</p><p>所以我们要对上面的算法进行改进，引入新的cost计算机制：</p><div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.mzule.al;</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> KeyboardLevenshteinDistance <span style="color: #0000ff;">extends</span><span style="color: #000000;"> LevenshteinDistance {    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> Map&lt;Character, String&gt;<span style="color: #000000;"> charSiblings;    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">double</span> SCORE_MIS_HIT = 0.1<span style="color: #000000;">;    </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> {        charSiblings </span>= <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();        charSiblings.put(</span>'q', "was"<span style="color: #000000;">);        charSiblings.put(</span>'w', "qsead"<span style="color: #000000;">);        charSiblings.put(</span>'e', "wsdfr"<span style="color: #000000;">);        charSiblings.put(</span>'r', "edfgt"<span style="color: #000000;">);        charSiblings.put(</span>'t', "rfghy"<span style="color: #000000;">);        charSiblings.put(</span>'y', "tghju"<span style="color: #000000;">);        charSiblings.put(</span>'u', "yhjki"<span style="color: #000000;">);        charSiblings.put(</span>'i', "ujklo"<span style="color: #000000;">);        charSiblings.put(</span>'o', "ikl;p"<span style="color: #000000;">);        charSiblings.put(</span>'p', "ol;'["<span style="color: #000000;">);        charSiblings.put(</span>'a', "qwsxz"<span style="color: #000000;">);        charSiblings.put(</span>'s', "qazxcdew"<span style="color: #000000;">);        charSiblings.put(</span>'d', "wsxcvfre"<span style="color: #000000;">);        charSiblings.put(</span>'f', "edcvbgtr"<span style="color: #000000;">);        charSiblings.put(</span>'g', "rfvbnhyt"<span style="color: #000000;">);        charSiblings.put(</span>'h', "tgbnmjuy"<span style="color: #000000;">);        charSiblings.put(</span>'j', "yhnm,kiu"<span style="color: #000000;">);        charSiblings.put(</span>'k', "ujm,.loi"<span style="color: #000000;">);        charSiblings.put(</span>'l', "ik,./;po"<span style="color: #000000;">);        charSiblings.put(</span>'z', "asx"<span style="color: #000000;">);        charSiblings.put(</span>'x', "zasdc"<span style="color: #000000;">);        charSiblings.put(</span>'c', "xsdfv"<span style="color: #000000;">);        charSiblings.put(</span>'v', "cdfgb"<span style="color: #000000;">);        charSiblings.put(</span>'b', "vfghn"<span style="color: #000000;">);        charSiblings.put(</span>'n', "bghjm"<span style="color: #000000;">);        charSiblings.put(</span>'m', "nhjk,"<span style="color: #000000;">);    }    @Override    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">double</span> cost(<span style="color: #0000ff;">char</span> c1, <span style="color: #0000ff;">char</span><span style="color: #000000;"> c2) {        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> keyboardDistance(c1, c2);    }    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">double</span> keyboardDistance(<span style="color: #0000ff;">char</span> c1, <span style="color: #0000ff;">char</span><span style="color: #000000;"> c2) {        </span><span style="color: #0000ff;">if</span> (c1 ==<span style="color: #000000;"> c2) {            </span><span style="color: #0000ff;">return</span> 0<span style="color: #000000;">;        }        String s </span>=<span style="color: #000000;"> charSiblings.get(c1);        </span><span style="color: #0000ff;">if</span> (s != <span style="color: #0000ff;">null</span> &amp;&amp; s.indexOf(c2) &gt; -1<span style="color: #000000;">) {            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> SCORE_MIS_HIT;        }        </span><span style="color: #0000ff;">return</span> 1<span style="color: #000000;">;    }    }</span></pre><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div><p><span style="line-height: 1.5;">上面的类继承自LevenshteinDistance ，重写了cost方法，根据键盘距离，对相邻的字母返回0.1，不相邻的字母返回距离1.&nbsp;</span></p><div class="cnblogs_code"><pre>cost('a','s')=0.1<span style="color: #000000;">cost(</span>'a','p')=1</pre></div><p>&nbsp;测试KeyboardLevenshteinDistance：</p><div class="cnblogs_code"><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {    </span><span style="color: #0000ff;">double</span> d = <span style="color: #0000ff;">new</span> KeyboardLevenshteinDistance().distance("thanks", "tjsmla"<span style="color: #000000;">);    System.out.println(d);}</span></pre></div><p>&nbsp;输出：0.5，和预期的结果一样。tjsmla与thanks非常相似，因为在新买的键盘还是不熟悉的情况下，误输入thanks为tjsmla也很正常。</p><p><span style="line-height: 1.5;">上面的算法完美了吗？of course not. 还有很多优化空间。比如：除了键盘距离，我们还可以考虑读音距离，对于读音相似的字母，也应该距离更近一些。比如说a与e，就很容易就混淆。对于结尾的t与te的距离应该更近一些，而不是1。但是这些都还是自己想法，不容易实现。欢迎指点。</span></p><p>最后，免责声明，本人水平有限，如有错误，欢迎指正。</p></div>
							</div>
							<div class="connect">
								<p class="time">
								Post at 2013-10-28 11:22:12
								</p>
							</div>
							<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1882897"></script>
<!-- UY END -->
							<div class="prenext">
							<div class="pre"><a href="think about solrappender.html">Newer Post:Solr-appender想到的</a></div>
							<div class="next"><a href="Java mail simple implements.html">Older Post:JAVA邮件发送的简单实现</a></div>
						</div>
						</div>
					</div>
				</li>
			</ul>
		</div>
		<div id="footer">
			<div>
				<div class="section">
					<h5>Navigation Menu</h5>
					<ul class="navigation">
						<li>
							<a href="index.html">Home</a>
						</li>
						<li>
							<a href="about.html">About</a>
						</li>
						<li>
							<a href="schedules.html">Class Schedules</a>
						</li>
						<li>
							<a href="performance.html">Performances</a>
						</li>
						<li>
							<a href="blog.html">Blog</a>
						</li>
						<li>
							<a href="contact.html">Contact</a>
						</li>
					</ul>
				</div>
				<div class="section">
					<h5>Recent Blog Posts</h5>
					<ul>
						<li>
							<a href="blog.html">Dance Tips &amp; Tricks: How To Know If Modern Dance Is Right For You</a>
						</li>
						<li>
							<a href="blog.html">Dance Tips &amp; Tricks: The Secrets To A Successful Dancing Career</a>
						</li>
						<li>
							<a href="blog.html">Daring Dancer: Harillsa Gortengkov</a>
						</li>
					</ul>
				</div>
				<div class="section">
					<h5>Studio Hours</h5>
					<ul>
						<li>
							Mondays to Fridays: 8am- 5pm
						</li>
						<li>
							Saturdays: 10am-5pm
						</li>
						<li>
							Sundays: 10am-12nn
						</li>
						<li>
							For Appointments: Call 262-956-6778
						</li>
					</ul>
				</div>
				<div class="section">
					<h5>Social</h5>
					<ul class="connect">
						<li>
							<a href="http://freewebsitetemplates.com/go/facebook/" target="_blank">Facebook</a>
						</li>
						<li>
							<a href="http://freewebsitetemplates.com/go/twitter/" target="_blank">Twitter</a>
						</li>
						<li>
							<a href="http://freewebsitetemplates.com/go/youtube/" target="_blank">Vimeo</a>
						</li>
						<li>
							<a href="http://freewebsitetemplates.com/go/googleplus/" target="_blank">Google+</a>
						</li>
					</ul>
					<h5>Newsletter Signup</h5>
					<form action="index.html" method="post" id="newsletter">
						<input type="text" value="Enter your email address" class="txtfield" onBlur="javascript:if(this.value==''){this.value=this.defaultValue;}" onFocus="javascript:if(this.value==this.defaultValue){this.value='';}">
						<input type="submit" value="" class="btn">
					</form>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

