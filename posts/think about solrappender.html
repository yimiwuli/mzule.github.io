<!DOCTYPE html>
<!-- Website template by freewebsitetemplates.com -->
<html>
<head>
	<meta charset="UTF-8">
	<title>Blog of MZULE | Solr-appender想到的</title>
	<link rel="stylesheet" href="../css/style.css" type="text/css">
</head>
<body>
	<div id="page">
		<div id="header">
			<div>
				<a href="../index.html" id="logo">MZULE</a>
				<ul id="navigation">
					<li>
						<a href="../index.html">home</a>
					</li>
					<li>
						<a href="../me.html">about</a>
					</li>
					<li>
						<a href="http://weibo.com/u/2634262551/home?wvr=5">weibo</a>
					</li>
					<li>
						<a href="http://stackoverflow.com/users/1985786/jason-cao">stackoverflow</a>
					</li>
					<li>
						<a href="http://github.com/mzule/">github</a>
					</li>
					<li>
						<a href="http://www.zhihu.com/people/mzule">zhihu</a>
					</li>
				</ul>
			</div>
		</div>


		<div id="contents">
			<ul id="blogs">
				<li>
					<div class="header">
						<div class="details">
							<h3><a href="posts/think about solrappender.html">Solr-appender想到的</a></h3>
							<div id="postContent">
							<div style="margin: 0; font-family: Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro,SimSun, Song, 宋体, 幼圆, Heiti, 黑体, 文泉驿等宽正黑, 文泉驿正黑, monospace; font-size: 13px;" data-mce-style="margin: 0; font-family: Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro,SimSun, Song, 宋体, 幼圆, Heiti, 黑体, 文泉驿等宽正黑, 文泉驿正黑, monospace; font-size: 13px;"><h1 style="font-size: 30px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;" data-mce-style="font-size: 30px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;"></h1><h2 style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;" data-mce-style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;">1. 背景</h2><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">前些日子分析线上日志感觉非常头疼。</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">第一，登录产线环境需要跳板机，速度不至于很慢，但也是不能忍受的事情。</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">第二，产线环境都是集群，有时候出错了都不知道该去哪台机器上去看错误日志。</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">第三，对自己而言，使用grep查询日志效率低。</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">综上，由于这些种种的原因，自己突然考虑：为什么日志不能直接写到<code style="font-size: 12px; padding: 3px 4px; color: #d14; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background-color: #f7f7f9; border: 1px solid #e1e1e8;" data-mce-style="font-size: 12px; padding: 3px 4px; color: #d14; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background-color: #f7f7f9; border: 1px solid #e1e1e8;">solr</code>服务上面去呢？单独开辟出来一个<code style="font-size: 12px; padding: 3px 4px; color: #d14; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background-color: #f7f7f9; border: 1px solid #e1e1e8;" data-mce-style="font-size: 12px; padding: 3px 4px; color: #d14; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background-color: #f7f7f9; border: 1px solid #e1e1e8;">solr</code>机器（集群就更好了XD）</p><h2 style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;" data-mce-style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;">2. 开发</h2><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">有了想法，二话不说，对log4j开刀，XXOO一会就解决了。方案见：</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;"><a href="https://github.com/mzule/solr-appender" target="_blank" data-mce-href="https://github.com/mzule/solr-appender">https://github.com/mzule/solr-appender</a></p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">我还煞有介事的写了Getting Stated和Wiki (事实上，这个最耗时)。</p><h2 style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;" data-mce-style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;">3. 应用</h2><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">写完之后，拿着运行的效果图，发了一个微博圈了老大，建议TEAM使用solr来管理我们的log，对于查询来说，solr绝对是一把利剑。老大的答复是：公司已经开发了一套基于搜索引擎的日志管理系统，马上就要上线了。还给了我一个体验地址。好吧，太巧合了。</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">公司的这套系统，是一个日志采集系统，采集线上生成的日志文件，然后写入到solr中方便查询的。刚开始我表示很不理解，为什么不直接把日志写入到solr而要费时费力的去写到文件然后再采集？</p><h2 style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;" data-mce-style="font-size: 24px; margin: 10px 0; font-weight: bold; color: #444; text-rendering: optimizelegibility; line-height: 36px;">4. 后记</h2><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">今天又是查线上的日志，想到要登录切换的登录机器去看日志，想想就头大。</p><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;">心想，为什么不能直接把日志记录在solr中呢？下面我们来分析分析：</p><ol style="margin: 0 0 9px 25px; padding: 0; list-style: decimal;" data-mce-style="margin: 0 0 9px 25px; padding: 0; list-style: decimal;"><li style="line-height: 22px;" data-mce-style="line-height: 22px;"><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;"><strong style="font-weight: bold;" data-mce-style="font-weight: bold;">性能：</strong>性能什么的我觉得应该不是什么问题，在网络比硬盘快的时代，瓶颈在于硬盘，所以solr在性能方面不是问题。</p></li><li style="line-height: 22px;" data-mce-style="line-height: 22px;"><p style="margin: 0 0 9px; font-size: 13px; line-height: 18px;" data-mce-style="margin: 0 0 9px; font-size: 13px; line-height: 18px;"><strong style="font-weight: bold;" data-mce-style="font-weight: bold;">安全：</strong>安全应该是一个使用solr记录日志所最需要考虑的一个问题了。记录日志文件是如此的重要，所以这个记录的过程应该越简单越好，保证错误的日志要能够被记录下来，而记录日志最简单的方式，可能就是写入文件了；将日志写入solr无疑会涉及比文件系统多的多的模块涉及进来，一个模块出现故障，日志就会丢失，所以安全性方面，solr不及文件系统。</p></li></ol></div>
							</div>
							<div class="connect">
								<p class="time">
								Post at 2013-12-30 12:12:12
								</p>
							</div>
							<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1882897"></script>
<!-- UY END -->
							<div class="prenext">
							<div class="pre"><a href="">Newer Post:</a></div>
							<div class="next"><a href="edit distance and spell check.html">Older Post:最小编辑距离，键盘距离与拼写纠正</a></div>
						</div>
						</div>
					</div>
				</li>
			</ul>
		</div>
		<div id="footer">
			<div>
				<div class="section">
					<h5>Navigation Menu</h5>
					<ul class="navigation">
						<li>
							<a href="index.html">Home</a>
						</li>
						<li>
							<a href="about.html">About</a>
						</li>
						<li>
							<a href="schedules.html">Class Schedules</a>
						</li>
						<li>
							<a href="performance.html">Performances</a>
						</li>
						<li>
							<a href="blog.html">Blog</a>
						</li>
						<li>
							<a href="contact.html">Contact</a>
						</li>
					</ul>
				</div>
				<div class="section">
					<h5>Recent Blog Posts</h5>
					<ul>
						<li>
							<a href="blog.html">Dance Tips &amp; Tricks: How To Know If Modern Dance Is Right For You</a>
						</li>
						<li>
							<a href="blog.html">Dance Tips &amp; Tricks: The Secrets To A Successful Dancing Career</a>
						</li>
						<li>
							<a href="blog.html">Daring Dancer: Harillsa Gortengkov</a>
						</li>
					</ul>
				</div>
				<div class="section">
					<h5>Studio Hours</h5>
					<ul>
						<li>
							Mondays to Fridays: 8am- 5pm
						</li>
						<li>
							Saturdays: 10am-5pm
						</li>
						<li>
							Sundays: 10am-12nn
						</li>
						<li>
							For Appointments: Call 262-956-6778
						</li>
					</ul>
				</div>
				<div class="section">
					<h5>Social</h5>
					<ul class="connect">
						<li>
							<a href="http://freewebsitetemplates.com/go/facebook/" target="_blank">Facebook</a>
						</li>
						<li>
							<a href="http://freewebsitetemplates.com/go/twitter/" target="_blank">Twitter</a>
						</li>
						<li>
							<a href="http://freewebsitetemplates.com/go/youtube/" target="_blank">Vimeo</a>
						</li>
						<li>
							<a href="http://freewebsitetemplates.com/go/googleplus/" target="_blank">Google+</a>
						</li>
					</ul>
					<h5>Newsletter Signup</h5>
					<form action="index.html" method="post" id="newsletter">
						<input type="text" value="Enter your email address" class="txtfield" onBlur="javascript:if(this.value==''){this.value=this.defaultValue;}" onFocus="javascript:if(this.value==this.defaultValue){this.value='';}">
						<input type="submit" value="" class="btn">
					</form>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

